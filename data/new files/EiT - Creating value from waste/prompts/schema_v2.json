{
  "type": "object",
  "required": ["company", "srm_assessment", "evidence", "sources"],
  "additionalProperties": false,
  "properties": {
    "company": {
      "type": "object",
      "required": [
        "input_name",
        "canonical_name",
        "legal_name",
        "org_number",
        "country",
        "homepage_url",
        "proff_url",
        "nace_codes",
        "employees",
        "revenue",
        "identity_evidence_ids",
        "nace_evidence_ids",
        "entity_resolution_notes"
      ],
      "additionalProperties": false,
      "properties": {
        "input_name": {
          "type": "string",
          "description": "The company name as provided in the input."
        },
        "canonical_name": {
          "anyOf": [{ "type": "string" }, { "type": "null" }],
          "description": "The canonical/common name of the company."
        },
        "legal_name": {
          "anyOf": [{ "type": "string" }, { "type": "null" }],
          "description": "The official legal name of the company."
        },
        "org_number": {
          "anyOf": [{ "type": "string" }, { "type": "null" }],
          "description": "Norwegian organization number. Only set if evidence exists."
        },
        "country": {
          "type": "string",
          "enum": ["Norway"]
        },
        "homepage_url": {
          "anyOf": [{ "type": "string" }, { "type": "null" }]
        },
        "proff_url": {
          "anyOf": [{ "type": "string" }, { "type": "null" }],
          "description": "URL to the company's Proff.no page."
        },
        "nace_codes": {
          "type": "array",
          "items": {
            "type": "string",
            "description": "NACE code without description."
          }
        },
        "employees": {
          "type": "object",
          "required": ["value", "year", "evidence_ids", "notes"],
          "additionalProperties": false,
          "properties": {
            "value": {
              "anyOf": [{ "type": "number" }, { "type": "null" }]
            },
            "year": {
              "anyOf": [{ "type": "number" }, { "type": "null" }]
            },
            "evidence_ids": {
              "type": "array",
              "items": { "type": "string" }
            },
            "notes": {
              "type": "string",
              "description": "String with [#] bracket citations."
            }
          }
        },
        "revenue": {
          "type": "object",
          "required": ["value", "currency", "year", "evidence_ids", "notes"],
          "additionalProperties": false,
          "properties": {
            "value": {
              "anyOf": [{ "type": "number" }, { "type": "null" }]
            },
            "currency": {
              "anyOf": [
                { "type": "string", "enum": ["NOK"] },
                { "type": "null" }
              ]
            },
            "year": {
              "anyOf": [{ "type": "number" }, { "type": "null" }]
            },
            "evidence_ids": {
              "type": "array",
              "items": { "type": "string" }
            },
            "notes": {
              "type": "string",
              "description": "String with [#] bracket citations."
            }
          }
        },
        "identity_evidence_ids": {
          "type": "array",
          "items": { "type": "string" }
        },
        "nace_evidence_ids": {
          "type": "array",
          "items": { "type": "string" }
        },
        "entity_resolution_notes": {
          "type": "string",
          "description": "String with [#] bracket citations."
        }
      }
    },
    "srm_assessment": {
      "type": "object",
      "required": [
        "overall_tier",
        "overall_summary",
        "srm_inputs",
        "gaps_and_uncertainties"
      ],
      "additionalProperties": false,
      "properties": {
        "overall_tier": {
          "type": "string",
          "enum": ["T0", "T1", "T2", "T3"]
        },
        "overall_summary": {
          "type": "string",
          "description": "String with [#] bracket citations."
        },
        "srm_inputs": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/srm_input"
          }
        },
        "gaps_and_uncertainties": {
          "type": "array",
          "items": {
            "type": "string",
            "description": "Each item is a string with [#] bracket citations."
          }
        }
      }
    },
    "evidence": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/evidence_item"
      }
    },
    "sources": {
      "type": "array",
      "items": {
        "$ref": "#/$defs/source_item"
      }
    }
  },
  "$defs": {
    "quantity": {
      "type": "object",
      "required": [
        "value",
        "unit",
        "dimension",
        "year",
        "period",
        "scope",
        "basis",
        "confidence",
        "evidence_id",
        "context"
      ],
      "additionalProperties": false,
      "properties": {
        "value": {
          "type": "number"
        },
        "unit": {
          "type": "string",
          "enum": ["t", "kg", "m3", "Nm3", "l", "kWh", "MWh", "GJ", "TJ"]
        },
        "dimension": {
          "type": "string",
          "enum": ["mass", "volume", "energy"]
        },
        "year": {
          "anyOf": [{ "type": "number" }, { "type": "null" }]
        },
        "period": {
          "type": "string",
          "enum": ["per_year", "per_month", "per_day", "one_off", "unknown"]
        },
        "scope": {
          "type": "string",
          "enum": ["company", "business_unit", "site", "product", "unknown"]
        },
        "basis": {
          "type": "string",
          "enum": [
            "actual_use",
            "received_input",
            "purchased_input",
            "permit_limit",
            "estimated",
            "other"
          ]
        },
        "confidence": {
          "type": "string",
          "enum": ["low", "medium", "high"]
        },
        "evidence_id": {
          "type": "string"
        },
        "context": {
          "type": "string",
          "description": "String with [#] bracket citations."
        }
      }
    },
    "share": {
      "type": "object",
      "required": [
        "value_percent",
        "basis",
        "year",
        "scope",
        "confidence",
        "evidence_id",
        "context"
      ],
      "additionalProperties": false,
      "properties": {
        "value_percent": {
          "type": "number"
        },
        "basis": {
          "type": "string",
          "enum": [
            "of_total_input",
            "of_product_mass",
            "of_feedstock",
            "other",
            "unknown"
          ]
        },
        "year": {
          "anyOf": [{ "type": "number" }, { "type": "null" }]
        },
        "scope": {
          "type": "string",
          "enum": ["company", "business_unit", "site", "product", "unknown"]
        },
        "confidence": {
          "type": "string",
          "enum": ["low", "medium", "high"]
        },
        "evidence_id": {
          "type": "string"
        },
        "context": {
          "type": "string",
          "description": "String with [#] bracket citations."
        }
      }
    },
    "srm_input": {
      "type": "object",
      "required": [
        "input_id",
        "mece_category_code",
        "label",
        "material_examples",
        "used_for",
        "tier",
        "tier_reasoning",
        "main_quantity",
        "other_quantities",
        "share",
        "evidence_ids",
        "confidence",
        "volume_notes",
        "uncertainties"
      ],
      "additionalProperties": false,
      "properties": {
        "input_id": {
          "type": "string"
        },
        "mece_category_code": {
          "type": "string",
          "enum": [
            "A1",
            "A2",
            "A3",
            "A4",
            "A5",
            "A6",
            "A7",
            "A8",
            "A9",
            "A10",
            "B1",
            "B2",
            "B3"
          ]
        },
        "label": {
          "type": "string"
        },
        "material_examples": {
          "type": "array",
          "items": { "type": "string" }
        },
        "used_for": {
          "type": "string",
          "description": "String with [#] bracket citations."
        },
        "tier": {
          "type": "string",
          "enum": ["T0", "T1", "T2", "T3"]
        },
        "tier_reasoning": {
          "type": "string",
          "description": "String with [#] bracket citations."
        },
        "main_quantity": {
          "anyOf": [{ "$ref": "#/$defs/quantity" }, { "type": "null" }]
        },
        "other_quantities": {
          "type": "array",
          "items": {
            "$ref": "#/$defs/quantity"
          }
        },
        "share": {
          "anyOf": [{ "$ref": "#/$defs/share" }, { "type": "null" }]
        },
        "evidence_ids": {
          "type": "array",
          "items": { "type": "string" }
        },
        "confidence": {
          "type": "string",
          "enum": ["low", "medium", "high"]
        },
        "volume_notes": {
          "type": "string",
          "description": "String with [#] bracket citations."
        },
        "uncertainties": {
          "type": "string",
          "description": "String with [#] bracket citations."
        }
      }
    },
    "evidence_item": {
      "type": "object",
      "required": [
        "evidence_id",
        "source_id",
        "evidence_snippet",
        "location_hint",
        "claim"
      ],
      "additionalProperties": false,
      "properties": {
        "evidence_id": {
          "type": "string"
        },
        "source_id": {
          "type": "number"
        },
        "evidence_snippet": {
          "type": "string",
          "description": "Verbatim snippet, max 25 words, original language."
        },
        "location_hint": {
          "anyOf": [{ "type": "string" }, { "type": "null" }],
          "description": "Page number, section heading, table name, or permit clause."
        },
        "claim": {
          "type": "string",
          "description": "Short English statement of what the snippet supports."
        }
      }
    },
    "source_item": {
      "type": "object",
      "required": [
        "source_id",
        "type",
        "title",
        "publisher",
        "year",
        "url",
        "file_type"
      ],
      "additionalProperties": false,
      "properties": {
        "source_id": {
          "type": "number"
        },
        "type": {
          "type": "string",
          "enum": [
            "proff",
            "annual_report",
            "sustainability_report",
            "esg_report",
            "permit",
            "norskeutslipp_permit",
            "epd",
            "product_sheet",
            "press_release",
            "about_page",
            "other"
          ]
        },
        "title": {
          "anyOf": [{ "type": "string" }, { "type": "null" }]
        },
        "publisher": {
          "anyOf": [{ "type": "string" }, { "type": "null" }]
        },
        "year": {
          "anyOf": [{ "type": "number" }, { "type": "null" }]
        },
        "url": {
          "type": "string"
        },
        "file_type": {
          "anyOf": [
            { "type": "string", "enum": ["pdf", "html", "other"] },
            { "type": "null" }
          ]
        }
      }
    }
  }
}
